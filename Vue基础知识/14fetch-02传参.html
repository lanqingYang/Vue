<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>fetch传参</title>
  </head>
  <body>
    <script>
      /* get 的传统传参和restful风格两种方式 */
      // 1.传统
      fetch("/books?id=123", {
        method: "get",
      })
        .then((data) => {
          return data.text();
        })
        .then((data) => {
          console.log(data);
        });

      //2.restful风格
      fetch("/books/345", {
        method: "get",
      })
        .then((data) => {
          return data.text();
        })
        .then((data) => {
          console.log(data);
        });

      /* delete方式传参 与get类似 */
      fetch("/books/345", {
        method: "delete",
      })
        .then((data) => {
          return data.text();
        })
        .then((data) => {
          console.log(data);
        });

      /* post请求方式的参数传递 用到body和header属性 */
      //1.普通格式
      fetch("/books", {
        method: "post",
        body: "username=tanghao&age=1",
        headers: {
          "Content-Type": "application/x-www-form-urlencoded",
        },
      })
        .then((data) => {
          return data.text();
        })
        .then((data) => {
          console.log(data);
        });
      //2. json格式
      fetch("/books", {
        method: "post",
        body: JSON.stringify({ username: "lanqing", age: 1 }),
        headers: {
          "Content-Type": "application/json",
        },
      })
        .then((data) => {
          return data.text();
        })
        .then((data) => {
          console.log(data);
        });

      /* put 请求方式传递参数，与post类似  put修改  传递id参数,也分为普通传参和json数据传参，见post*/
      fetch("/books/123", {
        method: "put",
        body: JSON.stringify({ username: "dudu", age: 1 }),
        headers: {
          "Content-Type": "application/json",
        },
      })
        .then((data) => {
          return data.text();
        })
        .then((data) => {
          console.log(data);
        });

      /* fetch相应结果的数据格式 */
      //json()  text()
      fetch("/json")
        .then(function (data) {
          // return data.json();
          return data.text();
        })
        .then(function (data) {
          // console.log(data.uname + " " + data.age);  //data为对象
          console.log(data); //字符串 14fetch-02传参.html:98 {"uname":"tanghao","age":1}
          //字符串转对象
          console.log(JSON.parse(data));
        });
    </script>
  </body>
</html>
